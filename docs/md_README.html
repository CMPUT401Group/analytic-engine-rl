<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>analytic-engine-rl: analytic-engine-rl</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">analytic-engine-rl
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">analytic-engine-rl </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Analytic Engine RL (Reinforcement Learning) module. Given a <em>goal metric</em> in some timespan (a <em>pattern</em>) <b>g</b>, this module will allow us to see what <em>pattern(s)</em> <b>P</b> in other metrics will <em>Likely</em> lead to <b>g</b>. A tool that can be very useful when analyzing thousands of metrics.</p>
<p><b>Note:</b> </p><blockquote class="doxtable">
<p>You might've noticed that given a goal pattern <b>g</b>, this module only gives a set of pattern <b>P</b> that entails <b>g</b>. This is just one level entailment. The method or the <em>RL Engine</em> used can actually do multi-level entailment. But since this project is still in its incipient stage, we stick with one level. </p>
</blockquote>
<h1>Reinforcement Learning and Metric Analysis</h1>
<p>This just seems like a perfect combination. The basic concept is <b>P -&gt; g</b>'s is given a positive reinforcement when it occurs, but negative reinforcement if <b>P -&gt; (not g)</b> occurs. The latter eliminates false positives, for instance if <b>p-&gt;q</b> and not <b>q-&gt;p</b>, <b>q-&gt;p</b> (false positive) will be eliminated. We take <em>n</em> random samples around the metrics (known as training). As <em>n</em> increase and the bigger our metric time span, the better AI's prediction model is (less false positives and such), much like a human observer.</p>
<h1>Compilation and Installation</h1>
<h3>Dependency:</h3>
<ul>
<li>g++-4.9 or greater</li>
<li>armadillo</li>
<li>cppunit</li>
<li><a href="https://github.com/JoeyAndres/rl/releases/tag/v2.0.1-beta.3">JoeyAndres/rl v2.0.1-beta.3</a> hehe, my pride and joy.</li>
</ul>
<h3>Installing dependencies Ubuntu:</h3>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# Install everything that can be installed from ubuntu package manager.</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;sudo apt install libarmadillo-dev libcppunit-dev g++</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;# Install my pride and joy.</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;cd /tmp</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;git clone https://github.com/JoeyAndres/rl.git</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;cd rl</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;mkdir build</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;cd build</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;cmake ..</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;make -j16</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;make install</div></div><!-- fragment --><h3>Building</h3>
<p>Once the dependencies are installed, you can start building:</p>
<ol type="1">
<li><code>git clone <a href="https://github.com/CMPUT401Group/analytic-engine-rl.git">https://github.com/CMPUT401Group/analytic-engine-rl.git</a></code></li>
<li>cd analytic-engine-rl</li>
<li><code>mkdir build</code></li>
<li><code>cd build</code></li>
<li><code>cmake ..</code></li>
<li><code>make -j16</code></li>
</ol>
<h1>Usage</h1>
<p>While still in the build directory:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# This will take a while to run due to 11,000 metrics to process.</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;./analytic-engine-rl-cli test/data/test-metrics.json test/data/config.json</div></div><!-- fragment --><p>Parameters:</p><ul>
<li><b>test/data/test-metrics.json</b>: This is simply a list of metrics. The format is: <div class="fragment"><div class="line">[</div><div class="line">  {<span class="stringliteral">&quot;target&quot;</span>: <span class="stringliteral">&quot;metricName&quot;</span>, datapoints: [ [y, x], ...]},</div><div class="line">  ...</div><div class="line">]</div></div><!-- fragment --></li>
<li><b>test/data/config.js</b>: Tells the cli program what is the goal pattern and some reinforcement learning parameters that should be good enough. <div class="fragment"><div class="line">{</div><div class="line">  <span class="comment">// The goal pattern to which our AI will try to find entailing patterns from</span></div><div class="line">  <span class="comment">// other metric.</span></div><div class="line">  <span class="stringliteral">&quot;goalPattern&quot;</span>: {</div><div class="line">    <span class="comment">// Name of the metric in which our pattern is located.</span></div><div class="line">    <span class="stringliteral">&quot;metric&quot;</span>: <span class="stringliteral">&quot;invidi.webapp.localhost_localdomain.request.total_response_time.mean&quot;</span>,</div><div class="line"></div><div class="line">    <span class="comment">// The begin time of our goal pattern (unix time stamp) in the metric.</span></div><div class="line">    <span class="stringliteral">&quot;timeBegin&quot;</span>: 1474111311,</div><div class="line"></div><div class="line">    <span class="comment">// The end time of our goal pattern (unix time stamp) in the metric.  </span></div><div class="line">    <span class="stringliteral">&quot;timeEnd&quot;</span>: 1474111440</div><div class="line">  },</div><div class="line"></div><div class="line">  <span class="comment">// The number of times our AI sample the metrics. The higher the more accurate the</span></div><div class="line">  <span class="comment">// model, but slower.</span></div><div class="line">  <span class="stringliteral">&quot;iterationCount&quot;</span>: 50,</div><div class="line"></div><div class="line">  <span class="comment">// This the initial reward for all new states. Since all reward are negative</span></div><div class="line">  <span class="comment">// in this environment, you can afford to go as low as you want.</span></div><div class="line">  <span class="stringliteral">&quot;initialReward&quot;</span>: -1000000.0,</div><div class="line"></div><div class="line">  <span class="stringliteral">&quot;reinforcementLearning&quot;</span>: {</div><div class="line">    <span class="comment">// The higher, the quicker our ai model converge to a solution, but less accurate. 0.1 is fine.</span></div><div class="line">    <span class="stringliteral">&quot;stepSize&quot;</span>: 0.1,</div><div class="line"></div><div class="line">    <span class="comment">// Discount rate. Not really useful atm since we only have one level of entailment. </span></div><div class="line">    <span class="comment">// Once we multi-level of entailment is opened up, a low number (close to 0) means</span></div><div class="line">    <span class="comment">// entailed pattern multiple levels ahead will have almost no influence on current</span></div><div class="line">    <span class="comment">// pattern&#39;s rewRd. A high discountRate (close to 1) means entailed pattern multiple</span></div><div class="line">    <span class="comment">// levels ahead will have more significant influence in our current pattern&#39;s reward.</span></div><div class="line">    <span class="stringliteral">&quot;discountRate&quot;</span>: 0.9</div><div class="line">  },</div><div class="line"></div><div class="line">  <span class="comment">// The output file of our result.</span></div><div class="line">  <span class="stringliteral">&quot;resultFile&quot;</span>: <span class="stringliteral">&quot;result.json&quot;</span></div><div class="line">}</div></div><!-- fragment --> <h3>Interpreting the result</h3>
</li>
</ul>
<p>In the result.json after running the the cli program with the test parameters should output:</p>
<div class="fragment"><div class="line">[</div><div class="line"><span class="comment">// First few outputs.</span></div><div class="line"><span class="comment">// ...</span></div><div class="line">  {</div><div class="line">      <span class="stringliteral">&quot;destPattern&quot;</span>: {</div><div class="line">        <span class="stringliteral">&quot;metric&quot;</span>: <span class="stringliteral">&quot;invidi.webapp.localhost_localdomain.request.total_response_time.mean&quot;</span>,</div><div class="line">        <span class="stringliteral">&quot;timeBegin&quot;</span>: 1474111311,</div><div class="line">        <span class="stringliteral">&quot;timeEnd&quot;</span>: 1474111311</div><div class="line">      },</div><div class="line">      <span class="stringliteral">&quot;reward&quot;</span>: -1000000,</div><div class="line">      <span class="stringliteral">&quot;sourcePattern&quot;</span>: {</div><div class="line">        <span class="stringliteral">&quot;metric&quot;</span>: <span class="stringliteral">&quot;invidi.webapp.localhost_localdomain.database.request.findEtl.success_gauge&quot;</span>,</div><div class="line">        <span class="stringliteral">&quot;timeBegin&quot;</span>: 1474111311,</div><div class="line">        <span class="stringliteral">&quot;timeEnd&quot;</span>: 1474111311</div><div class="line">      }</div><div class="line">  },</div><div class="line"><span class="comment">// The last few outputs.</span></div><div class="line"><span class="comment">// (Note: this is ran with scanStepSize=40, so results are inaccurate but should suffice).</span></div><div class="line">  {</div><div class="line">    <span class="stringliteral">&quot;destPattern&quot;</span>: {</div><div class="line">      <span class="stringliteral">&quot;metric&quot;</span>: <span class="stringliteral">&quot;invidi.webapp.localhost_localdomain.request.total_response_time.mean&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;timeBegin&quot;</span>: 1474111311,</div><div class="line">      <span class="stringliteral">&quot;timeEnd&quot;</span>: 1474111311</div><div class="line">    },</div><div class="line">    <span class="stringliteral">&quot;reward&quot;</span>: -979290.007555472,</div><div class="line">    <span class="stringliteral">&quot;sourcePattern&quot;</span>: {</div><div class="line">      <span class="stringliteral">&quot;metric&quot;</span>: <span class="stringliteral">&quot;invidi.webapp.localhost_localdomain.database.request.findAdsToKeep.start_gauge&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;timeBegin&quot;</span>: 1474111311,</div><div class="line">      <span class="stringliteral">&quot;timeEnd&quot;</span>: 1474111311</div><div class="line">    }</div><div class="line">  },</div><div class="line">  {</div><div class="line">    <span class="stringliteral">&quot;destPattern&quot;</span>: {</div><div class="line">      <span class="stringliteral">&quot;metric&quot;</span>: <span class="stringliteral">&quot;invidi.webapp.localhost_localdomain.request.total_response_time.mean&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;timeBegin&quot;</span>: 1474111311,</div><div class="line">      <span class="stringliteral">&quot;timeEnd&quot;</span>: 1474111311</div><div class="line">    },</div><div class="line">    <span class="stringliteral">&quot;reward&quot;</span>: -979290.007555472,</div><div class="line">    <span class="stringliteral">&quot;sourcePattern&quot;</span>: {</div><div class="line">      <span class="stringliteral">&quot;metric&quot;</span>: <span class="stringliteral">&quot;invidi.webapp.localhost_localdomain.cache.DEVICE_ID.count&quot;</span>,</div><div class="line">      <span class="stringliteral">&quot;timeBegin&quot;</span>: 1474111311,</div><div class="line">      <span class="stringliteral">&quot;timeEnd&quot;</span>: 1474111311</div><div class="line">    }</div><div class="line">  }</div><div class="line">]</div></div><!-- fragment --><ul>
<li><b>sourcePattern</b>: The entailing pattern.<ul>
<li><b>metric:</b> The metric in which this pattern is located.</li>
<li><b>timeBegin:</b> The beginning time where this pattern is located in the metric.</li>
<li><b>timeEnd:</b> The end time where this pattern is located in the metric.</li>
</ul>
</li>
<li><b>destPattern:</b> The entailed pattern.<ul>
<li><b>metric:</b> The metric in which this pattern is located.</li>
<li><b>timeBegin:</b> The beginning time where this pattern is located in the metric.</li>
<li><b>timeEnd:</b> The end time where this pattern is located in the metric.</li>
</ul>
</li>
<li><b>reward:</b> The value of transitioning from <b>sourcePattern</b> to <b>destPattern</b>. Due to the nature of this problem this values range from _-infinity_ to 0.</li>
</ul>
<p>Since we are still in the incipient stage of this project, <b>timeBegin</b>/**timeEnd** for both <b>sourcePattern</b> and <b>destPattern</b> is the same. This appears to be giving useful results, but there is nothing stopping us from having those having some offsets other than it would slow the development due to more things to test.</p>
<h1>TODOs</h1>
<ul>
<li>Not restrict to one level of entailment.</li>
<li>Not restrict source/destination Pattern to single timeBegin/timeEnd.</li>
<li>At the moment, we only use SARSA algorithm. There are actually better algorithms that allows for faster convergence, but we are still exploring so I'll stick with the simplest. <b>Allow to specify algorithm in config.json.</b></li>
<li><a href="https://github.com/JoeyAndres/rl">Reinforcment Learning Module</a><ul>
<li>Allow multi-threading. Atm, I have only explored cpu intrinsics (SSE/SSE2/AVX and such), but we could really benefit from multi-threading.</li>
<li>Atm, the AI model is stored in RAM. We should be able to store results in JSON file, or even better, utilized MongoDB (will help with many node js development).</li>
</ul>
</li>
<li>Visualization. Imagine multi-level entailment and visualization. That would be REALLY sweet. That is why I mentioned storing MongoDB as one of TODO, since with MeteorJS for node development, we could have our visualization updated automatically in real-time as our model changes in the backend. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
